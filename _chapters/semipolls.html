---
layout: chapter

title: Semipolls
subtitle: Check your local voting laws
description: Collection of surveys for the public

icon: fa-solid fa-square-poll-vertical

stack: 3

specific_css: true

special_css: [
	"chapters/semipolls/main",
	"chapters/semipolls/plug",
	"chapters/semipolls/polls",
	"mobile/chapters"
]
---

<div class="connection-container">
	<div class="database">
		<div class="database-level"><div class="database-dot"></div></div>
		<div class="database-level"><div class="database-dot"></div></div>
		<div class="database-level"><div class="database-dot"></div></div>
		<div class="database-top"></div>
	</div>

	<div class="plug-runway">
		<div class="plug">
			<div class="plug-cable"></div>

			<div class="plug-head">
				<div class="plug-head-step"></div>
				<div class="plug-head-step">
					<i class="plug-power-icon fa-solid fa-bolt"></i>
				</div>
				<div class="plug-head-step"></div>
			</div>
		</div>

		<div class="plug-prong-container">
			<div class="plug-prong"></div>
			<div class="plug-prong"></div>
		</div>
	</div>

	<div class="outlet">
		<div class="outlet-mouth"></div>

		<div class="outlet-eye-container">
			<div class="outlet-eye"></div>
			<div class="outlet-eye"></div>
		</div>
	</div>
</div>



<div class="semipoll-pack-container">
	{%- for pack in site.data.semipolls.active_packs %}
	<div class="semipoll-pack" data-pack="{{ pack.title | slugify }}" style="--border-color: {{ pack.color }};">
		<div class="semipoll-pack-title">
			{{ pack.title }} Pack
			<span class="semipoll-pack-date">Posted {{ pack.date | date: "%B %-d, %Y" }}</span>

			<div class="semipoll-pack-title-corner"></div>
			<div class="semipoll-pack-title-corner"></div>
		</div>
		
		<div class="semipoll-pack-border">
			<div class="semipoll-pack-wrapper">
				<div class="semipoll-gutter"></div>

				{%- for semipoll in pack.semipolls %}
				<div class="semipoll" data-type="{{ semipoll.type }}" data-title="{{ semipoll.title }}">
					<div class="semipoll-title">{{ semipoll.query }}</div>
	
	
	
					{%- if semipoll.type == "radio" or semipoll.type == "checkbox" %}
						{%- assign count = 0 -%}
						{%- for option in semipoll.options %}
							{% assign count = count | plus:1 %}
							<input
								type="{% if semipoll.type == "radio" %}radio{% else %}checkbox{% endif %}"
								name="{{ semipoll.title }}"
								id="{{ semipoll.title }}{{ count }}"
								value="{{ count }}"
								autocomplete="off"
							>
	
							<label class="container-option" for="{{ semipoll.title }}{{ count }}">
								<span class="option-text">{{ option }}</span>
								<div class="
									option-indicator
									{% if semipoll.type == "checkbox" %}
									checkbox-indicator
									{% endif %}
								">
									<div class="checkmark-stem-container">
										<div class="checkmark-stem"></div>
										<div class="checkmark-stem"></div>
									</div>
								</div>
								<span class="option-percent"></span>
								<div class="option-fill"></div>
							</label>
						{%- endfor %}
					
	
	
					{%- elsif semipoll.type == "short_answer" or semipoll.type == "long_answer" %}
						{%- if semipoll.type == "short_answer" %}
						<input
						{%- else %}
						<textarea
						{%- endif %}
							class="textbox"
							placeholder="Answer here..."
							spellcheck="false"
							maximum-scale="1"
							autocomplete="off"
							data-gramm="false"
							data-gramm_editor="false"
							data-enable-grammarly="false"
							{%- if semipoll.char_limit %}
							maxlength="{{ semipoll.char_limit }}"
							{%- endif %}
						{%- if semipoll.type == "short_answer" %}
						>
						{%- else %}
						></textarea>
						{%- endif %}
	
						<div class="textbox-bottom-container">
							<div class="char-count">
								<span class="current-char-count">0</span>/{{ semipoll.char_limit }}
							</div>
							<div class="tail"></div>
						</div>
	
	
	
					{%- elsif semipoll.type == "likert" %}
						<div class="likert-points-container">
							{%- assign count = 0 -%}
							{%- for point in site.data.icons.likert_points %}
								{%- assign count = count | plus:1 -%}
								<input
									type="radio"
									name="{{ semipoll.title }}"
									id="{{ semipoll.title }}{{ count }}"
									value="{{ count }}"
									autocomplete="off"
								>
								<label class="likert-point" for="{{ semipoll.title }}{{ count }}">
									<div class="likert-point-shape"></div>
									<div class="likert-point-text">{{ point.agreement | replace:" ","<br>" }}</div>
								</label>
							{%- endfor %}
						</div>
		
						<div class="average-container">
							<span class="average-enumerator">0</span>

							<div class="average-bar">
								{%- for i in (1..4) %}
								<span class="average-enumerator">{{ i }}</span>
								{%- endfor %}
								<div class="average-fill"></div>
							</div>

							<span class="average-enumerator">5</span>
						</div>
	
	
	
					{%- elsif semipoll.type == "likert2" %}
						<div class="likert-points-container">
							<div class="likert-extreme">Strongly Disagree</div>
	
							{%- for i in (1..5) %}
								<div class="likert-column">
									<div class="likert-enumerator">{{ i }}</div>
	
									<input
										type="radio"
										name="{{ semipoll.title }}"
										id="{{ semipoll.title }}{{ i }}"
										value="{{ i }}"
										autocomplete="off"
									>
	
									<label class="likert-point option-indicator" for="{{ semipoll.title }}{{ i }}">
										<div class="checkmark-stem-container">
											<div class="checkmark-stem"></div>
											<div class="checkmark-stem"></div>
										</div>
									</label>
								</div>
							{%- endfor %}
	
							<div class="likert-extreme">Strongly Agree</div>
						</div>
	
	
	
					{%- elsif semipoll.type == "likert3" %}
						<div class="likert-points-container">
							{%- assign count = 0 -%}
							{%- for point in site.data.icons.likert_points %}
								{%- assign count = count | plus:1 -%}
								<input
									type="radio"
									name="{{ semipoll.title }}"
									id="{{ semipoll.title }}{{ count }}"
									value="{{ count }}"
									autocomplete="off"
								>
								<label class="likert-point" for="{{ semipoll.title }}{{ count }}">
									<span class="likert-point-emoji"><i class="fa-regular fa-{{ point.emoji }}"></i></span>
									<span class="likert-point-text">{{ point.agreement | replace:" ","<br>" }}</span>
								</label>
							{%- endfor %}
						</div>
	
	
	
					{%- endif %}
		
	
	
					<div class="semipoll-bottom">
						<div class="semipoll-info" tooltip="
						{%- if semipoll.type == "radio" -%}
							This is a radio multiple choice poll. Select your option and click submit. Your response will be tallied anonymously.
						{%- elsif semipoll.type == "checkbox" -%}
							This is a checkbox multiple choice poll. Select your option(s) and click submit. Your response will be tallied anonymously.
						{%- elsif semipoll.type == "short_answer" -%}
							This is a short answer poll. Type your answer and click submit. Your response will be recorded anonymously.
						{%- elsif semipoll.type == "long_answer" -%}
							This is a long answer poll. Type your answer and click submit. Your response will be recorded anonymously.
						{%- elsif semipoll.type == "likert" -%}
							This is a likert scale poll. Select your option and click submit. Your response will be tallied anonymously.
						{%- endif -%}
						" flow="top"><i class="fas fa-question-circle"></i></div>
		
						<div class="semipoll-count"></div>
		
						<button class="btn-alt submit-btn" autocomplete="off" disabled>
							<span class="submit-text">Submit</span>
							<div class="btn-loading-dots-container">
								<div></div>
								<div></div>
								<div></div>
							</div>
						</button>
					</div>
				</div>
				{%- endfor %}
			</div>
		</div>
	</div>
	{%- endfor %}
</div>



<script src="https://unpkg.com/packery@2/dist/packery.pkgd.min.js"></script>
<script>
	// Poll Masonry Layout
	$(document).ready(function() {
		$(".semipoll-pack-wrapper").packery({
			itemSelector: ".semipoll",
			gutter: ".semipoll-gutter",
			percentPosition: true
		});

		$.get("https://semipedia-backend.herokuapp.com/plug.php", function(xhr) {
			connected = true;
		});

		var startTime = Date.now();
		var timer = setInterval(function() {
			elapsedTime = Date.now() - startTime;

			if (connected = true && elapsedTime >= 1000) {
				clearInterval(timer);
				$(".connection-container").addClass("connected");
			}
		}, 1);
	});



	// Likert Shape Design
	$(`.likert-point-shape`).each(function(index) {
		var index = index + 1;
		$(this).load("../img/likert-shapes/shape" + index + ".svg");
	});



	// Enable button functions
	$(`input[type="radio"], input[type="checkbox"]`).change(function() {
		var semipoll = $(this).closest(".semipoll");
		if (semipoll.find("input").is(":checked")) semipoll.find(".submit-btn").removeAttr("disabled");
		else semipoll.find(".submit-btn").prop("disabled", true);
	});

	$(".textbox").keyup(function() {
		var semipoll = $(this).closest(".semipoll");
		if ($(this).val()) semipoll.find(".submit-btn").removeAttr("disabled");
		else semipoll.find(".submit-btn").prop("disabled", true);
	});

	$(".textbox").on("propertychange input", function() {
		var charCount = $(this).val().length;
		var semipoll = $(this).closest(".semipoll");
		semipoll.find(".current-char-count").html(charCount);
	});



	// Submit function
	$(".submit-btn").click(function() {
		var semipoll = $(this).closest(".semipoll");
		var pack = semipoll.closest(".semipoll-pack").attr("data-pack");
		var type = semipoll.attr("data-type");
		var title = semipoll.attr("data-title");
		var url = "https://semipedia-backend.herokuapp.com/types/" + type + ".php";

		semipoll.find(".submit-btn").addClass("btn-loading");


		// Define response type
		if (type == "radio" || type == "likert")
			response = semipoll.find("input:checked").val();

		else if (type == "checkbox") {
			var checkedValues = [];
			semipoll.find("input:checked").each(function() {
				checkedValues.push($(this).attr("value"));
			});
			response = JSON.stringify(checkedValues);
		}

		else if (type == "short_answer" || "long_answer")
			response = semipoll.find(".textbox").val();


		// Actual ajax call
		$.ajax({
			type: "GET",
			data: {
				pack: pack,
				type: type,
				title: title,
				response: response
			},
			url: url,
			success: function(xhr) {
				if (type == "radio" || type == "checkbox") {
					var options = JSON.parse(xhr);
					total = options.reduce((a, b) => a + b, 0);
					for (i = 0; i < options.length; i++) {
						var percentage = (options[i] / total * 100).toFixed(1) + "%";
						semipoll.find(".option-percent").eq(i).html(percentage);
						semipoll.find(".option-fill").eq(i).css("width", percentage);
					}
				}

				else if (type == "short_answer" || type == "long_answer") total = xhr;

				else if (type == "likert") {
					var points = JSON.parse(xhr);
					total = points.reduce((a, b) => a + b, 0);
					var weightedAverage = 0;

					$.each(points, function(index, val) {
						var pointPercentage = (val / total * 100).toFixed(1) + "%";
						semipoll.find(".point-text").eq(index).html(pointPercentage);
						var weightedProportion = (index + 1) * (val / total);
						weightedAverage += weightedProportion;
					});

					semipoll.find(".average-bar .average-enumerator").each(function(i) {
						if (i + 1 < weightedAverage) $(this).addClass("enumerator-difference");
					});
					
					var averagePercentage = (weightedAverage / 5 * 100).toFixed(1) + "%";
					$(".average-fill").css("width", averagePercentage);
				}

				semipoll.addClass("submitted");

				var titleHeight = semipoll.find(".semipoll-title").height();
				semipoll.find(".semipoll-title").html("Thanks!").height(titleHeight);
				semipoll.find(".submit-btn").removeClass("btn-loading").prop("disabled", true);
			
				if (total == 1) semipoll.find(".semipoll-count").html(total + " response");
				else semipoll.find(".semipoll-count").html(total + " responses");
			}
		});
	});
</script>